---
import { ClientRouter } from "astro:transitions";
import { getRelativeLocaleUrl } from "astro:i18n";
import { useTranslations } from "../i18n/utils";

const currentLang = Astro.currentLocale || "es";
const t = useTranslations(currentLang as "es" | "en");

interface Props {
	title: string;
	description?: string;
	image?: string;
}

const { title, description, image } = Astro.props;

// SEO defaults
const siteUrl = "https://alejandro-vazquez.com";
const defaultDescription = t("intro");
const defaultImage = `${siteUrl}/images/og-image.jpg`; // You can create this later
const pageDescription = description || defaultDescription;
const pageImage = image || defaultImage;

// Canonical URL
const canonicalURL = new URL(Astro.url.pathname, siteUrl).href;

// Alternate language URL
const alternateLang = currentLang === "es" ? "en" : "es";
const alternateURL = canonicalURL.replace(
	`/${currentLang}/`,
	`/${alternateLang}/`,
);
---

<!doctype html>
<html lang={currentLang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/images/av.svg" />
		<meta name="generator" content={Astro.generator} />

		<!-- Primary Meta Tags -->
		<title>{title}</title>
		<meta name="title" content={title} />
		<meta name="description" content={pageDescription} />
		<meta
			name="keywords"
			content="Alejandro Vazquez, Alejandro Vázquez, artist, creative director, new media art, portfolio, digital art, contemporary art"
		/>
		<meta name="author" content="Alejandro Vazquez" />
		<link rel="canonical" href={canonicalURL} />

		<!-- Language Alternates -->
		<link rel="alternate" hreflang={currentLang} href={canonicalURL} />
		<link rel="alternate" hreflang={alternateLang} href={alternateURL} />
		<link rel="alternate" hreflang="x-default" href={`${siteUrl}/es/`} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="profile" />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={pageDescription} />
		<meta property="og:image" content={pageImage} />
		<meta
			property="og:locale"
			content={currentLang === "es" ? "es_ES" : "en_US"}
		/>
		<meta
			property="og:locale:alternate"
			content={currentLang === "es" ? "en_US" : "es_ES"}
		/>
		<meta property="profile:first_name" content="Alejandro" />
		<meta property="profile:last_name" content="Vazquez" />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={canonicalURL} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={pageDescription} />
		<meta property="twitter:image" content={pageImage} />

		<!-- JSON-LD Structured Data -->
		<script
			type="application/ld+json"
			set:html={JSON.stringify({
				"@context": "https://schema.org",
				"@type": "Person",
				name: "Alejandro Vazquez",
				alternateName: "Alejandro Vázquez",
				jobTitle:
					currentLang === "es"
						? "Artista y Director Creativo"
						: "Artist & Creative Director",
				description: pageDescription,
				url: siteUrl,
				image: pageImage,
				sameAs: [
					"https://www.instagram.com/camelcompact99/",
					"https://www.linkedin.com/in/alejandro-vazquez-a9b7162a4/",
					"https://www.tiktok.com/@camelcompact99",
				],
				email: "vazquez.tome.alejandro@gmail.com",
			})}
		/>

		<ClientRouter />
	</head>

	<body>
		<slot />
	</body>
</html>

<style is:global>
	@font-face {
		font-family: PP Neue Montreal Medium;
		src: url("/fonts/PPNeueMontreal-Medium.woff2") format("woff2");
		font-style: normal;
		font-weight: 400;
		line-height: normal;
		font-display: swap;
	}
	@font-face {
		font-family: OT Bulb Monoline;
		src: url("/fonts/OTBulbMonoline-500.woff2") format("woff2");
		font-display: swap;
	}

	@font-face {
		font-family: PP Neue Montreal Mono;
		src: url("/fonts/PPSupplyMono-Ultralight.woff2") format("woff2");
		font-display: swap;
	}

	::-webkit-scrollbar {
		display: none;
	}

	html {
		width: 100%;
		margin: 0;
		padding: 0%;
		overflow-x: hidden;
		scroll-behavior: smooth;
		scroll-snap-type: y mandatory;
		font-family: "PP Neue Montreal Medium", Arial, Helvetica, sans-serif;
		color: #000;
		font-size: 1rem;
		font-style: normal;

		background: rgba(224, 224, 224, 1);
		max-width: 100vw;
	}

	p {
		text-justify: inter-character;
	}
	button {
		all: unset;
	}
	body {
		margin: 0;
		width: 100%;
	}
	.contenido img {
		max-width: 110%;
		height: auto;
	}
	.contenido p {
		font-size: 1rem;
		font-weight: 400;
	}
	.contenido p:first-of-type {
		margin-top: 0%;
	}
	.contenido h3 {
		font-size: 1.8rem;
		font-weight: 400;
	}

	h2 {
		font-size: 5rem;
		margin-bottom: 0;
		font-weight: 400;
	}

	@media (max-width: 640px) {
		h2 {
			font-size: 3rem;
		}
	}
	@media (max-width: 1030px) {
		.contenido p {
			width: 95%;
		}
		.contenido h2 {
			max-width: 95%;
		}
		.contenido img {
			max-width: 100%;
			height: auto;
		}
	}
</style>

<script is:inline>
	document.addEventListener("astro:page-load", () => {
		const hiddenElements = document.querySelectorAll(".enfocar");
		const elements = document.querySelectorAll(".element");
		const textos = document.querySelectorAll(".textover");
		const preview = document.getElementById("lol");
		const big = document.getElementById("esoes");
		const infoBox = document.getElementById("info-box");

		if (window.matchMedia("(min-width: 1030px)").matches) {
			const observador = new IntersectionObserver(
				(entries) => {
					entries.forEach((entry) => {
						const ratio = entry.intersectionRatio; // Cuánto está siendo visible
						if (ratio > 0.2) {
							entry.target.style.opacity = 1; // Visible completamente
						} else {
							entry.target.style.opacity = 0; // Oculto
						}
					});
				},
				{
					root: null, // Usa el viewport como referencia
					threshold: Array.from({ length: 11 }, (_, i) => i * 0.1), // [0, 0.1, ..., 1] para pantallas grandes
				},
			);

			hiddenElements.forEach((el) => observador.observe(el));
		} else {
			const observador = new IntersectionObserver(
				(entries) => {
					entries.forEach((entry) => {
						const ratio = entry.intersectionRatio; // Cuánto está siendo visible

						if (ratio > 0.1) {
							entry.target.style.opacity = 1; // Visible completamente
						} else {
							entry.target.style.opacity = 0; // Oculto
						}
					});
				},
				{
					root: null, // Usa el viewport como referencia
					threshold: [0.1], // Solo 0.1 para pantallas pequeñas
				},
			);

			hiddenElements.forEach((el) => observador.observe(el));
		}
	});
</script>
