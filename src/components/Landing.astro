---
import { getCollection } from "astro:content";
import InteractiveLogo from "../components/jsx/InteractiveLogo.jsx";
import { useTranslations } from "../i18n/utils";
const works = await getCollection("works");
const currentLang = Astro.currentLocale || "es";
const translateLabels = useTranslations(currentLang as "es" | "en");

import { getImage } from "astro:assets";

const filteredWorks = works.filter(
    (work) => work.slug.startsWith(`${currentLang}/`) && work.data.depthmap,
);

const imagesWithDepth = await Promise.all(
    filteredWorks.map(async (work) => {
        const optimizedImage = await getImage({
            src: work.data.image,
            width: 800, // Increased resolution for better quality on the plane
            format: "webp",
        });
        const optimizedDepth = await getImage({
            src: work.data.depthmap!,
            width: 800,
            format: "webp",
        });
        const optimizedThumbnail = await getImage({
            src: work.data.image,
            width: 10, // Low resolution for unique preload blur
            format: "webp",
        });
        return {
            texture: optimizedImage.src,
            depth: optimizedDepth.src,
            thumbnail: optimizedThumbnail.src,
        };
    }),
);
---

{/* Preload all thumbnail images for faster initial display */}
{
    imagesWithDepth.map((img) => (
        <link rel="preload" as="image" href={img.thumbnail} />
    ))
}

<section class="hero" id="landing">
    <div class="logo">
        <InteractiveLogo client:only="react" images={imagesWithDepth} />
    </div>
    <div class="textos">
        <p>this is Alejandro VÃ¡zquez`s website</p>
        <p> here you can find <a href="#grid">[his works]</a>,  <a href="#contact">[his social]</a></p>
    </div>
</section>

<style>
    .hero {
        height: 100vh;
        max-width: 100%;
        position: relative; /* Needed for absolute positioning of children */
        background-color: black;
    }
    .logo {
        display: flex;
        flex-direction: column;
        height: 95%;
        justify-content: flex-end;
        margin: auto;
    }
    .logo-container {
        flex-grow: 1;
        width: 100%;
        position: relative;
    }
    .textos {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        left: 0;
        width: auto;
        max-width: calc(100% - 2rem); 
        width: 300px;
        padding-left: 2rem;
        padding-right: 2rem;
        padding-top: 0.65rem;
        font-size: 14px;
        z-index: 5;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        text-align: justify;
        color: white;
        
    }
    .enlaces {
        display: flex;
        justify-content: space-between;
        max-width: 60%;
        gap: 1rem;
    }
    .textos p {
        margin: 0;
    }
    .textos a {
        text-decoration: none;
        color: white;
    }
    .textos a:hover {
        color: #00ff0d;
    }
   
</style>
